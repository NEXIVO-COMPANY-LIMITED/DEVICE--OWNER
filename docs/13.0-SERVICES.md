# 13.0 CONFIGURED SERVICES

This document describes every **Android Service** used by the Device Owner app: purpose, lifecycle, and configuration.

---

## 1. SecurityMonitorService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.monitoring.SecurityMonitorService` |
| **Type** | Foreground (dataSync) |
| **directBootAware** | Yes |

**Purpose**

- Run as a **foreground service** so heartbeat and monitoring continue when the app is closed or in background.
- **Heartbeat**: Starts `HeartbeatService` in-process and schedules a heartbeat every **30 seconds** (exact interval; not WorkManager).
- **Security monitoring**: Every 2 seconds checks Developer Options, USB debugging, and tamper (bootloader, etc.); every 500 ms checks if Settings app is in foreground. On violation, triggers soft lock.
- **Real-Time Security Mesh**:
  - **DeviceOwnerRemovalDetector**: Every 5 seconds verifies the app is still Device Owner; on removal → hard lock + remote wipe.
  - **AccessibilityGuard**: Monitors unauthorized accessibility services; triggers soft lock when detected.

**Start**

- `SecurityMonitorService.startService(context)` — called from `DeviceOwnerApplication` when a device ID exists (after registration).

---

## 2. RemoteManagementService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.services.RemoteManagementService` |
| **Type** | Foreground (dataSync) |
| **directBootAware** | Yes |

**Purpose**

- Handles remote management commands and long-running management tasks in the background.
- Works with `RemoteDeviceControlManager` for lock/unlock and other server-driven actions.

---

## 3. SoftLockOverlayService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.services.SoftLockOverlayService` |
| **Type** | Foreground (dataSync) |

**Purpose**

- Shows a **soft lock** overlay (full-screen or overlay window) when the server or local policy requires a “soft” lock (e.g. warning screen without full kiosk).
- Works with `SoftLockMonitorService` and lock strategies (`LockScreenStrategy`, `EnhancedSoftLockActivity`).

---

## 4. SoftLockMonitorService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.services.SoftLockMonitorService` |
| **Type** | Foreground (dataSync) |

**Purpose**

- Monitors conditions that require showing the soft lock overlay and coordinates with `SoftLockOverlayService`.

---

## 5. FirmwareSecurityMonitorService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.services.FirmwareSecurityMonitorService` |
| **Type** | Foreground (dataSync) |

**Purpose**

- Monitors firmware/device integrity (e.g. root, custom ROM, system modifications) and triggers appropriate tamper response when violations are detected.

---

## 6. LocalDataServerService

| Attribute | Value |
|-----------|--------|
| **Class** | `com.example.deviceowner.services.LocalDataServerService` |
| **Type** | Foreground (dataSync) |
| **directBootAware** | Yes |

**Purpose**

- Runs a **local HTTP server** that serves device data (e.g. JSON) for debugging or local tools. Started from `DeviceOwnerApplication.onCreate()`.

---

## Summary Table

| Service | Foreground | directBootAware | Main role |
|---------|------------|-----------------|-----------|
| SecurityMonitorService | Yes (dataSync) | Yes | Heartbeat 30s, security/tamper checks, Security Mesh |
| RemoteManagementService | Yes (dataSync) | Yes | Remote management commands |
| SoftLockOverlayService | Yes (dataSync) | No | Soft lock overlay UI |
| SoftLockMonitorService | Yes (dataSync) | No | Soft lock condition monitoring |
| FirmwareSecurityMonitorService | Yes (dataSync) | No | Firmware/integrity monitoring |
| LocalDataServerService | Yes (dataSync) | Yes | Local HTTP device data server |

All foreground services use `foregroundServiceType="dataSync"` as declared in the manifest and `PROPERTY_FOREGROUND_SERVICE_TYPES`.
