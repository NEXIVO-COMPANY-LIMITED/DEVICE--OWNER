# 3.0 DEVICE COMPATIBILITY

This document describes **device compatibility** checks used before and during provisioning: what is validated and how the user is guided.

---

## Overview

The app checks that the device is suitable for **Device Owner** provisioning and operation. Checks run during the in-app setup flow (e.g. **ProvisioningProgressActivity**) and may block or warn if requirements are not met.

---

## DeviceOwnerCompatibilityChecker

**Class**: `com.microspace.payo.device.DeviceOwnerCompatibilityChecker`

### What is checked

1. **Android version**  
   - Must be **Android 13 or higher** (API 33+).  
   - If lower, compatibility fails with a message like: â€œAndroid version must be 13 or higher (current: X).â€

2. **Stock Android / supported manufacturer**  
   - Device should run **stock Android** or be from a **supported manufacturer**.  
   - **isStockAndroid()**: heuristic (e.g. build tags, brand) to detect stock vs custom ROM.  
   - **isSupportedManufacturer(manufacturer)**: allowlist of known manufacturers (e.g. Google, Samsung).  
   - If not stock and not supported, issue: â€œDevice must run stock Android or be from a supported manufacturer.â€

3. **Device brand**  
   - **isValidDeviceBrand(brand)**: validates brand (e.g. Pixel, Samsung). Unusual brands may log a warning but do not necessarily fail the check.

### Result

- **CompatibilityResult**: `isCompatible: Boolean`, `deviceInfo: DeviceInfo`, `issues: List<String>`.  
- **DeviceInfo**: brand, model, androidVersion, isStockAndroid, manufacturer.  
- If `issues` is empty â†’ compatible; otherwise not compatible.  
- **details** (string): human-readable status, device details, and list of issues.

### Where it is used

- **ProvisioningProgressActivity**: during initialization, calls `DeviceOwnerCompatibilityChecker.checkCompatibility()`.  
  - If compatible â†’ navigate to **CompatibilitySuccessActivity** / **DeviceCompatibilitySuccessActivity**.  
  - If not â†’ navigate to **CompatibilityFailureActivity** with the result (and issues).  
- **DeviceCompatibilityCheckActivity** can be the entry screen that leads into this flow.

---

## DeviceOwnerManager (minimum SDK)

- **DeviceOwnerManager** uses a minimum SDK of **API 31** (Android 12) for policy application.  
- Compatibility checker enforces **API 33+** (Android 13) for provisioning so that only devices meeting the higher bar are set up as Device Owner.

---

## Summary

| Check | Requirement |
|-------|--------------|
| Android version | 13+ (API 33) |
| OS type | Stock Android or supported manufacturer |
| Brand | Validated (warning only for unusual brands) |

Related: [4.0 Device Installation](4.0-DEVICE-INSTALLATION.md), [1.0 Device Owner Overview](1.0-DEVICE-OWNER-OVERVIEW.md).


